digraph PingTopology {
  node [shape=box]

  FlowSync [label="kilda.flow.sync", shape=hexagon]
  FLInput [shape=hexagon]

  PingTick [shape=ellipse]
  MonotonicTick [shape=ellipse]
  
  FLOutput [shape=octagon]
  FlowSync_out [label="kilda.flow.sync", shape=octagon]

  FlowSync -> SyncDecoder
  SyncDecoder -> FlowSyncObserver
  FlowSyncObserver -> FlowRouter [label="flows"]
  
  FlowRouter -> FlowManager [label="grouping"]
  FlowManager -> PingRouter [label="ping init"]
  PingRouter -> PingManager [label="grouping"]
  FlowManager -> FlowSyncEncoder [label="flow management"]
  FlowSyncEncoder -> FlowSync_out

  FLInput -> FLDecoder
  FLDecoder -> PingRouter  [label="ping response"]
  PingManager -> FlowRouter  [label="ping result/timeout"]
  PingManager -> FLEncoder  [label="ping request"]
  FLEncoder -> FLOutput

  PingTick -> FlowManager  [label="ping cycle"]
  MonotonicTick -> FlowSyncObserver  [label="initial load"]
  MonotonicTick -> PingManager  [label="timeout"]
}
